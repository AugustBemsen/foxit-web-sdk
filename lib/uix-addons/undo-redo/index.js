!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("UIExtension")):"function"==typeof define&&define.amd?define(["UIExtension"],n):"object"==typeof exports?exports.UndoRedoAddon=n(require("UIExtension")):t.UndoRedoAddon=n(t.UIExtension)}(self,(function(t){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(o,r,function(n){return t[n]}.bind(null,r));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=5)}([function(n,e){n.exports=t},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e(18);Object.defineProperty(n,"MARKUP_ANNOTATION_STATE",{enumerable:!0,get:function(){return(t=o,t&&t.__esModule?t:{default:t}).default;var t}});n.BORDER_STYLE={SOLID:0,DASHED:1,UNDERLINE:2,BEVELED:3,INSET:4,CLOUDY:5},n.POINT_TYPE={MOVE_TO:1,LINE_TO:2,LINE_TO_CLOSE_FIGURE:3,BEZIER_TO:4,BEZIER_TO_CLOSE_FIGURE:5},n.Intents={LINE_ARROW:"LineArrow",LINE_DIMENSION:"LineDimension",POLYGON_CLOUD:"PolygonCloud",POLYGON_DIMENSION:"PolygonDimension",POLYLINE_DIMENSION:"PolyLineDimension",CIRCLE_DIMENSION:"CircleDimension",FREETEXT_TYPEWRITER:"FreeTextTypewriter",FREETEXT_CALLOUT:"FreeTextCallout",STRIKEOUT_TEXTEDIT:"StrikeOutTextEdit"};var r=n.LineEndingName={0:"None",1:"Square",2:"Circle",3:"Diamond",4:"OpenArrow",5:"ClosedArrow",6:"Butt",7:"ROpenArrow",8:"RClosedArrow",9:"Slash"};n.LineEndingStyle=Object.keys(r).reduce((function(t,n){return t[r[n]]=Number(n),t}),{}),n.LINE_CAPTION_POSITION={POS_INLINE:0,POS_TOP:1},n.AnnotFlagsName={0:"invisible",1:"hidden",2:"print",3:"nozoom",4:"norotate",5:"noview",6:"readonly",7:"locked",8:"togglenoview"},n.PDFDocPermission={PrintLowQuality:4,ModifyDocument:8,Extract:16,AnnotForm:32,FillForm:256,ExtractAccess:512,Assemble:1024,PrintHighQuality:2048},n.MeasureType={MeasureTypeX:0,MeasureTypeY:1,MeasureTypeD:2,MeasureTypeA:3,MeasureTypeT:4,MeasureTypeS:5},n.STORE_NAMES={SELECTION_INFO:"viewer--store-selection-info"},n.CREATING_MEASUREMENT_CONTEXTMENU="creating-measurement-contextmenu",n.HIGHLIGHTING_MODE={NONE:0,INVERT:1,OUTLINE:2,PUSH:3,TOGGLE:4},n.RESOLVED_PROMISE_VOID=Promise.resolve(),n.DISTANCE_TOLERANCE=2,n.POINT_TOLERANCE=.01,n.POS_TYPE={FIRST:0,LAST:1,AFTER:2,BEFORE:3},n.STANDARD_HTML_ELEMENTS=["html","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],n.EMPTY_STR="",n.DB_PREFIX="FoxitPDFSDKForWeb_",n.SET_FORM_CREATION_CONTINUOUSLY="set_form_creation_continuously",n.HIDE_FORM_FIELD_PROPERTY_BOX="hideFormFieldPropertyBox",n.HIDE_FORM_FIELD_SIMPLE_PROPERTY_BOX="hideFormFieldSimplePropertyBox"},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e(3),r=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}(e(0));function i(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}function a(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):function(t,n){for(var e=Object.getOwnPropertyNames(n),o=0;o<e.length;o++){var r=e[o],i=Object.getOwnPropertyDescriptor(n,r);i&&i.configurable&&void 0===t[r]&&Object.defineProperty(t,r,i)}}(t,n))}function u(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var s=r.PDFViewCtrl.Deps.jQuery,c=r.UIEvents,f=function(){function t(n,e){u(this,t),this.pdfViewer=n,this.controller=e}return t.prototype.init=function(){var t=this.controller;this.pdfViewer.registerMatchRule((function(n,e){return function(n){function e(){return u(this,e),i(this,n.apply(this,arguments))}return a(e,n),e.prototype.setColor=function(e){var r=this,i=this.annot.getBorderColor();return n.prototype.setColor.call(this,e).then((function(n){var e=r.annot.getBorderColor();return t.create("annot",o.ANNOTATION.SETCOLOR,{annot:r.annot,oldColor:i,newColor:e}),n}))},e.prototype.setOpacity=function(e){var r=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i&&a&&t.create("annot",o.ANNOTATION.SETOPACITY,{annot:this.annot,oldOpacity:a.oldValue,newOpacity:a.commitValue});var u=this.annot.getOpacity();return n.prototype.setOpacity.call(this,e).then((function(n){var e=r.annot.getOpacity();return i&&!a&&t.create("annot",o.ANNOTATION.SETOPACITY,{annot:r.annot,oldOpacity:u,newOpacity:e}),n}))},e.prototype.setFillColor=function(e){var r=this,i=this.annot.getStyleFillColor||this.annot.getFillColor,a=i.call(this.annot);return n.prototype.setFillColor.call(this,e).then((function(n){var e=i.call(r.annot);return t.create("annot",o.ANNOTATION.SETFILLCOLOR,{annot:r.annot,oldFillColor:a,newFillColor:e}),n}))},e.prototype.setBorderWidth=function(e){var r=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i&&a&&t.create("annot",o.ANNOTATION.SETBORDERWIDTH,{annot:this.annot,oldBorderWidth:a.oldValue,newBorderWidth:a.commitValue});var u=this.annot.getBorderWidth();return n.prototype.setBorderWidth.call(this,e).then((function(n){var e=r.annot.getBorderWidth();return i&&!a&&t.create("annot",o.ANNOTATION.SETBORDERWIDTH,{annot:r.annot,oldBorderWidth:u,newBorderWidth:e}),n}))},e.prototype.setBorderStyle=function(e,r){var i=this,a=this.annot.getBorderStyleWithParam();return n.prototype.setBorderStyle.call(this,e,r).then((function(n){var e=i.annot.getBorderStyleWithParam();return t.create("annot",o.ANNOTATION.SETBORDERSTYLE,{annot:i.annot,oldBorderStyle:a,newBorderStyle:e}),n}))},e.prototype.setEndingStyle=function(e,r){var i=this,a=void 0,u=(a=e?this.annot.getStartStyle||this.annot.getCalloutLineEndingStyle:this.annot.getEndingStyle).call(this.annot);return n.prototype.setEndingStyle.call(this,e,r).then((function(n){var r=a.call(i.annot);return t.create("annot",o.ANNOTATION.SETENDINGSTYLE,{annot:i.annot,isStart:e,oldStyle:u,newStyle:r}),n}))},e.prototype.enableCaption=function(e){var r=this,i=this.annot.hasCaption();return n.prototype.enableCaption.call(this,e).then((function(n){var e=r.annot.hasCaption();return t.create("annot",o.ANNOTATION.ENABLECAPTION,{annot:r.annot,oldEnableCaption:i,newEnableCaption:e}),n}))},e.prototype.setRotation=function(e){var r=this,i=this.annot.getRotation(),a=this.annot.getRect();return n.prototype.setRotation.call(this,e).then((function(n){var e=r.annot.getRotation(),u=r.annot.getRect();return t.create("annot",o.ANNOTATION.SETROTATION,{annot:r.annot,oldRotation:i,newRotation:e,oldRect:a,newRect:u}),n}))},e.prototype.setHighlightingMode=function(e){var r=this,i=this.annot.getHighlightingMode();return n.prototype.setHighlightingMode.call(this,e).then((function(n){var e=r.annot.getHighlightingMode();return t.create("annot",o.ANNOTATION.SETHIGHLIGHTINGMODE,{annot:r.annot,oldHlMode:i,newHlMode:e}),n}))},e.prototype.removeAnnot=function(){var e=Object.assign({},this.annot),r=this.annot.getReplies&&this.annot.getReplies().slice(0),i=this.annot.isReplace&&this.annot.isReplace()&&"strikeout"===this.annot.info.type;return n.prototype.removeAnnot.call(this).then((function(n){return"sound"===e.info.type||"widget"===e.info.type||i||t.create("annot",o.ANNOTATION.REMOVEANNOT,{annot:e,replies:r}),n}))},e.prototype.textBoundaryStart=function(){t.before("annot",o.ANNOTATION.UPDATEQUADPOINTSBYCHARINDEX,{annot:this.annot,oldStart:this.annot.getStartCharIndex(),oldEnd:this.annot.getEndCharIndex()})},e.prototype.textBoundaryEnd=function(){t.after("annot",o.ANNOTATION.UPDATEQUADPOINTSBYCHARINDEX,{annot:this.annot,newStart:this.annot.getStartCharIndex(),newEnd:this.annot.getEndCharIndex()})},e.prototype.onStartUpdateShape=function(e){return"resize"===e&&"freetext"===this.annot.getType()&&this.annot.getIntent&&"FreeTextCallout"===this.annot.getIntent()?t.before("annot",o.ANNOTATION.UPDATECALLOUTPOINTS,{annot:this.annot,oldRect:this.annot.getRect(),oldCalloutLinePoints:this.annot.getCalloutLinePoints(),oldInnerRect:this.annot.getInnerRect()}):t.before("annot",o.ANNOTATION.SETRECT,{annot:this.annot,oldRect:this.annot.getRect()}),n.prototype.onStartUpdateShape.apply(this,arguments)},e.prototype.onShapeUpdateEnd=function(e){var r=this,i=n.prototype.onShapeUpdateEnd.apply(this,arguments);return"resize"===e&&"freetext"===this.annot.getType()&&this.annot.getIntent&&"FreeTextCallout"===this.annot.getIntent()?i.then((function(){t.after("annot",o.ANNOTATION.UPDATECALLOUTPOINTS,{annot:r.annot,newRect:r.annot.getRect(),newCalloutLinePoints:r.annot.getCalloutLinePoints(),newInnerRect:r.annot.getInnerRect()})})):i.then((function(){t.after("annot",o.ANNOTATION.SETRECT,{annot:r.annot,newRect:r.annot.getRect()})}))},e.prototype.boundaryChangeStart=function(n){if("line"===this.annot.getType())switch(s(n.target).data("index")){case 0:case 1:t.before("annot",o.ANNOTATION.UPDATELINEPOINTS,{annot:this.annot,oldStartPoint:this.annot.getStartPoint(),oldEndPoint:this.annot.getEndPoint()});break;case 2:case 3:t.before("annot",o.ANNOTATION.SETLEADERLINELENGTH,{annot:this.annot,oldLeaderLinePoints:this.annot.getLeaderLinePoints(),oldStartPoint:this.annot.getStartPoint(),oldEndPoint:this.annot.getEndPoint()})}else t.before("annot",o.ANNOTATION.UPDATEVERTEXES,{annot:this.annot,oldVertexes:this.annot.getVertexes(),oldIndex:s(n.target).data("index")})},e.prototype.boundaryChangeEnd=function(n){var e=s(n.target).data("index")||s(n.target).parent().data("index");if("line"===this.annot.getType())switch(e){case 0:case 1:t.after("annot",o.ANNOTATION.UPDATELINEPOINTS,{annot:this.annot,newStartPoint:this.annot.getStartPoint(),newEndPoint:this.annot.getEndPoint()});break;case 2:case 3:t.after("annot",o.ANNOTATION.SETLEADERLINELENGTH,{annot:this.annot,newLeaderLinePoints:this.annot.getLeaderLinePoints(),newStartPoint:this.annot.getStartPoint(),newEndPoint:this.annot.getEndPoint()})}else t.after("annot",o.ANNOTATION.UPDATEVERTEXES,{annot:this.annot,newVertexes:this.annot.getVertexes(),newIndex:e})},e.prototype.setContent=function(e){var r=this,i=this.annot.getContent();return n.prototype.setContent.call(this,e).then((function(n){var e=r.annot.getContent();if(e!==i)if("freetext"===r.annot.getType()){var a=r.annot.getInnerRect(),u=r.annot.getRect(),s=r.annot.getCalloutLinePoints();t.create("annot",o.ANNOTATION.SETCONTENT,{annot:r.annot,oldContent:i,newContent:e,oldInnerRect:r.oldInnerRect,newInnerRect:a,oldRect:r.oldRect,newRect:u,oldCalloutLinePoints:r.oldCalloutLinePoints,newCalloutLinePoints:s})}else t.create("annot",o.ANNOTATION.SETCONTENT,{annot:r.annot,oldContent:i,newContent:e});return n}))},e.prototype.placeRedact=function(e){return n.prototype.placeRedact.call(this,e).then((function(n){var e=[];return n.map((function(t){var n=t[0];e.push(n)})),t.create("annot",o.ANNOTATION.PLACEREDACT,{redacts:e}),n}))},e.prototype.setDefaultAppearance=function(e,r){var i=this,a=this.annot.getDefaultAppearance();return n.prototype.setDefaultAppearance.call(this,e,r).then((function(n){var e=i.annot.getDefaultAppearance();t.create("annot",o.ANNOTATION.DEFAULTAP,{annot:i.annot,oldDA:a,newDA:e})}))},e}(e)})),this.bindEvent()},t.prototype.bindEvent=function(){var t=this.controller,n=this.pdfViewer;n.eventEmitter.on(c.addReplySuccess,(function(n,e){"sound"!==n.info.type&&t.create("annot",o.ANNOTATION.ADDREPLY,{annot:n,replyAnnot:e})})),n.eventEmitter.on(c.deleteReplySuccess,(function(n,e){t.create("annot",o.ANNOTATION.DELETEREPLY,{annot:n,replyAnnot:e})})),n.eventEmitter.on(c.addActionSuccess,(function(n){t.create("annot",o.ANNOTATION.ADDACTION,{annot:n})})),n.eventEmitter.on(c.eraserSuccess,(function(n,e){t.create("annot",o.ANNOTATION.ERASER,{beforeInks:n,afterInks:e})})),n.eventEmitter.on(c.addAnnotSuccess,(function(n){t.create("annot",o.ANNOTATION.ADDANNOT,{annot:n})})),n.eventEmitter.on(c.applyRedaction,(function(n){t.clear()})),n.eventEmitter.on(c.addContentSuccess,(function(n,e,r){t.create("annot",o.ANNOTATION.SETCONTENT,{annot:n,oldContent:e,newContent:r})})),n.eventEmitter.on(c.cancelAddAnnot,(function(){t.popUndoStack()})),n.eventEmitter.on("markRedactAnnotSuccess",(function(n){t.create("annot",o.ANNOTATION.MARKREDACTANNOT,{annot:n})})),n.eventEmitter.on("makeRedactByPagesSuccess",(function(n){t.create("annot",o.ANNOTATION.MAKEREDACTBYPAGES,{redacts:n})})),n.eventEmitter.on(c.markRedactionSuccess,(function(n){t.create("annot",o.ANNOTATION.MARKCHECKEDRESULTREDACTION,{redacts:n})})),n.eventEmitter.on(c.addReviewStateSuccess,(function(n,e){"sound"!==n.info.type&&t.create("annot",o.ANNOTATION.ADDREVIEWSTATE,{annot:n,stateName:e.getState()})})),n.eventEmitter.on(c.moveAnnotsToPages,(function(n,e,r){t.create("annot",o.ANNOTATION.moveAnnotsCrossPage,{srcPage:n,destPage:e,annots:r})}));var e=function(){return t.clear()};n.eventEmitter.on(c.importPages,e),n.eventEmitter.on(c.pageAdded,e),n.eventEmitter.on(c.pageRemoved,e),n.eventEmitter.on(c.pagesRemoved,e),n.eventEmitter.on(c.pageRotationChange,e),n.eventEmitter.on(c.pagesRotated,e),n.eventEmitter.on(c.pageMoved,e),n.eventEmitter.on(c.pagesMoved,e)},t}();n.default=f},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ANNOTATION={SETCOLOR:"ANNOTATIONSETCOLOR",SETOPACITY:"ANNOTATIONSETOPACITY",SETFILLCOLOR:"ANNOTATIONSETFILLCOLOR",SETBORDERWIDTH:"ANNOTATIONSETBORDERWIDTH",SETBORDERSTYLE:"ANNOTATIONSETBORDERSTYLE",SETENDINGSTYLE:"ANNOTATIONSETENDINGSTYLE",ENABLECAPTION:"ANNOTATIONENABLECAPTION",SETROTATION:"ANNOTATIONSETROTATION",SETHIGHLIGHTINGMODE:"ANNOTATIONSETHIGHLIGHTINGMODE",REMOVEANNOT:"REMOVEANNOT",ADDANNOT:"ADDANNOT",SETRECT:"ANNOTATIONSETRECT",UPDATEQUADPOINTSBYCHARINDEX:"UPDATEQUADPOINTSBYCHARINDEX",UPDATECALLOUTPOINTS:"ANNOTATIONUPDATECALLOUTPOINTS",UPDATELINEPOINTS:"ANNOTATIONUPDATELINEPOINTS",SETLEADERLINELENGTH:"ANNOTATIONSETLEADERLINELENGTH",UPDATEVERTEXES:"ANNOTATIONUPDATEVERTEXES",SETCONTENT:"ANNOTATIONSETCONTENT",PLACEREDACT:"ANNOTATIONPLACEREDACT",ADDREPLY:"ANNOTATIONADDREPLY",DELETEREPLY:"ANNOTATIONDELETEREPLY",ADDACTION:"ANNOTATIONADDACTION",ERASER:"ANNOTATIONERASER",MARKREDACTANNOT:"ANNOTATIONMARKREDACTANNOT",MAKEREDACTBYPAGES:"ANNOTATIONMAKEREDACTBYPAGES",MARKCHECKEDRESULTREDACTION:"MARKCHECKEDRESULTREDACTION",ADDREVIEWSTATE:"ADDREVIEWSTATE",DEFAULTAP:"DEFAULTAP",moveAnnotsCrossPage:"moveAnnotsCrossPage"}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var t={};return t.promise=new Promise((function(n,e){t.resolve=n,t.reject=e})),t}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o,r=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}(e(0)),i=e(6),a=e(20),u=(o=a)&&o.__esModule?o:{default:o};function s(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function c(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n}function f(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):function(t,n){for(var e=Object.getOwnPropertyNames(n),o=0;o<e.length;o++){var r=e[o],i=Object.getOwnPropertyDescriptor(n,r);i&&i.configurable&&void 0===t[r]&&Object.defineProperty(t,r,i)}}(t,n))}var l=function(t){function n(){return s(this,n),c(this,t.apply(this,arguments))}return f(n,t),n.getName=function(){return"undo-redo"},n.getLoader=function(){return u.default},n.prototype.init=function(n){var e=this;t.prototype.init.call(this,n),this.addonPromise=n.getPDFViewer().then((function(t){if(!t.collaborationOptions||!t.collaborationOptions.enable)return e.addon=new i.UndoRedoAddon(t),e.addon.init(),e.addon}))},n.prototype.receiveAction=function(t,n){return this.addonPromise.then((function(e){if(!e)throw new Error("undo/redo is not supported when collaboration is enabled!");return e[t](n)}))},n}(r.UIXAddon);n.default=l},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.UndoRedoAddon=void 0;var o,r=e(7),i=(o=r)&&o.__esModule?o:{default:o};n.UndoRedoAddon=i.default},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}(e(0)),r=u(e(8)),i=u(e(10)),a=u(e(2));function u(t){return t&&t.__esModule?t:{default:t}}var s=o.UIEvents,c=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.pdfViewer=n}return t.prototype.init=function(){var t=this,n=this.undoRedoManager=new r.default(this.pdfViewer),e=this.controller=new i.default(this.pdfViewer,n);new a.default(this.pdfViewer,e).init();var o=this.pdfViewer.getKeyboardEventBinder("pdf-viewer-keyboard-event-binder");this.removeUndo=o.before("undo",(function(n){var e=n.nativeEvent.target;"true"!==e.contentEditable&&"TEXTAREA"!==e.tagName&&"INPUT"!==e.tagName&&(n.preventDefault(),t.undo())})),this.removeRedo=o.before("redo",(function(n){var e=n.nativeEvent.target;"true"!==e.contentEditable&&"TEXTAREA"!==e.tagName&&"INPUT"!==e.tagName&&(n.preventDefault(),t.redo())})),this.pdfViewer.eventEmitter.on(s.willCloseDocument,(function(){e.clear()}))},t.prototype.undo=function(){this.controller.undo()},t.prototype.redo=function(){this.controller.redo()},t.prototype.undoAll=function(){return this.controller.undoAll()},t}();n.default=c},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});r(e(2));var o=r(e(9));function r(t){return t&&t.__esModule?t:{default:t}}var i=function(){function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.pdfViewer=n,this.controller=e,this.undoStack=new o.default,this.redoStack=new o.default}return t.prototype.storage=function(t){this.undoStack.push(t)},t.prototype.undo=function(){var t=this.undoStack.pop();if(t)return this.redoStack.push(t),t},t.prototype.redo=function(){var t=this.redoStack.pop();if(t)return this.undoStack.push(t),t},t.prototype.removeById=function(t){this.undoStack.filter((function(n){return t!==n.uniqueId})),this.redoStack.filter((function(n){return t!==n.uniqueId}))},t.prototype.clear=function(){this.undoStack.clear(),this.redoStack.clear()},t.prototype.getUndoStack=function(){return this.undoStack},t.prototype.getRedoStack=function(){return this.redoStack},t}();n.default=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.stackArray=[]}return t.prototype.push=function(t){this.stackArray.push(t)},t.prototype.pop=function(){return this.stackArray.pop()},t.prototype.size=function(){return this.stackArray.length},t.prototype.clear=function(){this.stackArray=[]},t.prototype.filter=function(t){this.stackArray=this.stackArray.filter(t)},t}();n.default=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=i(e(11)),r=i(e(19));function i(t){return t&&t.__esModule?t:{default:t}}var a=function(){function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.pdfViewer=n,this.undoRedoManager=e,this.annoutInitStatesManager={};var i=Promise.resolve();this.interpreter={annot:new o.default(n),user:new r.default(n),undo:function(t){return i=i.finally((function(){return t.undo()}))},redo:function(t){i=i.finally((function(){return t.redo()}))}}}return t.prototype.before=function(t,n,e){this.beforeData={type:t,fnName:n,data:e}},t.prototype.after=function(t,n,e){var o=this.beforeData;o.type===t||o.fnName===n?this.create(t,n,Object.assign(o.data,e)):this.beforeData=null},t.prototype.create=function(t,n,e){1===Object.keys(e).length&&e.annot&&(this.annoutInitStatesManager[e.annot.id]=e.annot),this.undoRedoManager.storage(this.interpreter[t][n](e)),this.undoRedoManager.getRedoStack().clear()},t.prototype.clear=function(){this.undoRedoManager.clear(),this.annoutInitStatesManager={}},t.prototype.undo=function(){var t=this.undoRedoManager.undo();t&&this.interpreter.undo(t)},t.prototype.redo=function(){var t=this.undoRedoManager.redo();t&&this.interpreter.redo(t)},t.prototype.popUndoStack=function(){this.undoRedoManager.getUndoStack().pop()},t.prototype.undoAll=function(){for(var t in this.annoutInitStatesManager){var n=this.annoutInitStatesManager[t],e=this.pdfViewer.getAnnotRender(n.page.info.index,n.id);e&&e.component&&e.component.hideUI()}for(var o=this,r="",i=[];r=this.undoRedoManager.undo();)!function(t){i.push((function(){return o.interpreter.undo(t)}))}(r);return i.reduce((function(t,n){return t.then((function(){return n()}))}),Promise.resolve())},t}();n.default=a},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e(3),r=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}(e(0)),i=s(e(12)),a=s(e(13)),u=e(14);function s(t){return t&&t.__esModule?t:{default:t}}r.PDFViewCtrl.Consts.Intents;var c=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.pdfViewer=n}return t.prototype[o.ANNOTATION.SETCOLOR]=function(t){var n=t.annot,e=t.oldColor,o=t.newColor,r=this.pdfViewer;function i(t){return function(){var e=f(r,n);return-1===t&&(t=0),e.annot.setBorderColor(t).then((function(){e.updateRender()}))}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.SETOPACITY]=function(t){var n=t.annot,e=t.oldOpacity,o=t.newOpacity,r=this.pdfViewer;function i(t){return function(){var e=f(r,n);return e.annot.setOpacity(t).then((function(){e.updateRender()}))}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.SETFILLCOLOR]=function(t){var n=t.annot,e=t.oldFillColor,o=t.newFillColor,r=this.pdfViewer;function i(t){return function(){var e=f(r,n);(e.annot.setStyleFillColor||e.annot.setFillColor).call(e.annot,t)}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.SETBORDERWIDTH]=function(t){var n=t.annot,e=t.oldBorderWidth,o=t.newBorderWidth,r=this.pdfViewer;function i(t){return function(){return f(r,n).annot.setBorderWidth(t)}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.SETBORDERSTYLE]=function(t){var n=t.annot,e=t.oldBorderStyle,o=t.newBorderStyle,r=this.pdfViewer;function i(t){return function(){return f(r,n).annot.setBorderStyle(t.style,t.param)}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.SETENDINGSTYLE]=function(t){var n=t.annot,e=t.isStart,o=t.oldStyle,r=t.newStyle,i=this.pdfViewer;function a(t){return function(){var o=f(i,n);return o.annot.setCalloutLineEndingStyle?o.annot.setCalloutLineEndingStyle(+t).then((function(){o.redraw(),o.activeRect()})):o.annot.setEndingStyle(e,+t).then((function(){o.redraw(),o.activeRect()}))}}return{undo:a(o),redo:a(r)}},t.prototype[o.ANNOTATION.ENABLECAPTION]=function(t){var n=t.annot,e=t.oldEnableCaption,o=t.newEnableCaption,r=this.pdfViewer;function i(t){return function(){return f(r,n).annot.enableCaption(t)}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.SETROTATION]=function(t){var n=t.annot,e=t.oldRotation,o=t.newRotation,r=t.oldRect,i=t.newRect,a=this.pdfViewer;function u(t,e){return function(){var o=f(a,n);return"screen"===n.getType()?o.annot.setRect(e).then((function(n){if(n)return o.annot.setRotation((t+360)%360).then((function(){o.activeRect()}))})):o.annot.setRotation((t+360)%360).then((function(){o.activeRect()}))}}return{undo:u(e,r),redo:u(o,i)}},t.prototype[o.ANNOTATION.SETHIGHLIGHTINGMODE]=function(t){var n=t.annot,e=t.oldHlMode,o=t.newHlMode,r=this.pdfViewer;function i(t){return function(){return f(r,n).annot.setHighlightingMode(t)}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.REMOVEANNOT]=function(t){var n=t.annot,e=t.replies,o=this.pdfViewer;return{undo:l(n,o,!1,e),redo:d(n,o)}},t.prototype[o.ANNOTATION.ADDANNOT]=function(t){var n=t.annot,e=this.pdfViewer;return{undo:d(n,e),redo:l(n,e,!1,n.replies),annot:n}},t.prototype[o.ANNOTATION.UPDATEQUADPOINTSBYCHARINDEX]=function(t){var n=t.annot,e=t.oldStart,o=t.oldEnd,r=t.newStart,i=t.newEnd,a=this.pdfViewer;function u(t,e){return function(){var o=f(a,n);return o.annot.updateQuadPointsByCharIndex(t,e).then((function(){if(o.redraw(),o.isReplace)return o.caretAnnot.moveRectByCharIndex(e).then((function(){o.getGroupRenders().map((function(t){t.active()}))}));o.active()}))}}return{undo:u(e,o),redo:u(r,i)}},t.prototype[o.ANNOTATION.SETRECT]=function(t){var n=t.annot,e=t.oldRect,o=t.newRect,r=this.pdfViewer;function i(t){return function(){var e=f(r,n);return e.annot.setRect(t).then((function(){e.redraw(),e.active()}))}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.UPDATECALLOUTPOINTS]=function(t){var n=t.annot,e=t.oldRect,o=t.oldCalloutLinePoints,r=t.oldInnerRect,i=t.newRect,a=t.newCalloutLinePoints,u=t.newInnerRect,s=this.pdfViewer;function c(t,e,o){return function(){var r=f(s,n);return r.annot._setRect(t,!1).then((function(){return r.annot.setInnerRectNoAction(o).then((function(){return r.annot.setCalloutLinePoints(e).then((function(){return r.annot.update().then((function(){r.redraw(),r.active()}))}))}))}))}}return{undo:c(e,o,r),redo:c(i,a,u)}},t.prototype[o.ANNOTATION.UPDATELINEPOINTS]=function(t){var n=t.annot,e=t.oldStartPoint,o=t.oldEndPoint,r=t.newStartPoint,i=t.newEndPoint,a=this.pdfViewer;function u(t,e){return function(){var o=[],r=f(a,n);return o.push(r.annot.setStartPoint(t)),o.push(r.annot.setEndPoint(e)),Promise.all(o).then((function(){r.active()}))}}return{undo:u(e,o),redo:u(r,i)}},t.prototype[o.ANNOTATION.SETLEADERLINELENGTH]=function(t){var n=t.annot,e=t.oldLeaderLinePoints,o=t.oldStartPoint,r=t.oldEndPoint,i=t.newLeaderLinePoints,a=t.newStartPoint,u=t.newEndPoint,s=this.pdfViewer;function c(t,e,o){var r=t.start,i=(t.end,Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))),a=!0;return(o.x-e.x)*(r.y-o.y)-(r.x-o.x)*(o.y-e.y)>0&&(a=!1),a&&(i=-i),function(){var t=f(s,n);return t.annot.setLeaderLineLength(i).then((function(){t.active()}))}}return{undo:c(e,o,r),redo:c(i,a,u)}},t.prototype[o.ANNOTATION.UPDATEVERTEXES]=function(t){var n=t.annot,e=t.oldVertexes,o=t.oldIndex,r=t.newVertexes,i=t.newIndex,a=this.pdfViewer;function u(t,e){return function(){var o=f(a,n);return o.annot.updateVertexes(t,e[t]).then((function(){o.active()}))}}return{undo:u(o,e),redo:u(i,r)}},t.prototype[o.ANNOTATION.SETCONTENT]=function(t){var n=t.annot,e=t.oldContent,o=t.newContent,r=t.oldInnerRect,i=t.newInnerRect,a=t.oldRect,u=t.newRect,s=t.oldCalloutLinePoints,c=t.newCalloutLinePoints,l=this.pdfViewer;function d(t,e,o,r){return function(){var i=f(l,n);return i.annot.setContent(t).then((function(){return o&&i.annot.setRect(o).then((function(){return e&&i.annot.setInnerRect(e).then((function(){return r&&i.annot.setCalloutLinePoints(r).then((function(){i.redraw(),i.active()}))}))}))}))}}return{undo:d(e,r,a,s),redo:d(o,i,u,c)}},t.prototype[o.ANNOTATION.PLACEREDACT]=function(t){var n=t.redacts;return{undo:function(){return Promise.all(n.map((function(t){return t.getPDFPage().removeAnnot(t)})))},redo:function(){return Promise.all(n.map((function(t){var n=new i.default(t).getJson();return t.getPDFPage().markRedactAnnot([t.info.rect],n)})))}}},t.prototype[o.ANNOTATION.ADDREPLY]=function(t){var n=t.annot,e=t.replyAnnot,o=this.pdfViewer;return{undo:h(n,e,o),redo:p(n,e,o)}},t.prototype[o.ANNOTATION.DELETEREPLY]=function(t){var n=t.annot,e=t.replyAnnot,o=this.pdfViewer;return{undo:p(n,e,o),redo:h(n,e,o)}},t.prototype[o.ANNOTATION.ADDACTION]=function(t){var n=t.annot,e=this.pdfViewer,o=n.getAction();return{undo:function(){return n.removeAction()},redo:function(){return function(t,n){return t.setAction(n.type).then((function(){var e=new a.default(n).toJson();return t.setActionData(e).then((function(){return function t(n,e){for(var o=e.subActionCount,r=[],i=function(o){r.push(n.insertSubAction(o,e.subAction[o].type).then((function(){var r=new RecoveryAction(e.subAction[o]).toJson(),i=n.getSubAction(o);return i.setActionData(r).then((function(){return t(i,e.subAction[o])}))})))},a=0;a<o;a++)i(a);return Promise.all(r)}(t.getAction(),n)}))}))}(f(e,n).annot,o.info)}}},t.prototype[o.ANNOTATION.ERASER]=function(t){var n=t.beforeInks,e=t.afterInks,o=this.pdfViewer;return{undo:function(){var t=n.map((function(t){var n=t.annot,e=t.inkList;return t.isRemove?l(n,o,!0)().then((function(){f(o,n).annot.setInkList(e)})):f(o,n).annot.setInkList(e)}));return Promise.all(t)},redo:function(){var t=e.map((function(t){var n=t.annot;t.inkList;return t.isRemove?d(n,o)():f(o,t.annot).annot.setInkList(t.inkList)}));return Promise.all(t)}}},t.prototype[o.ANNOTATION.MARKREDACTANNOT]=function(t){var n=t.annot,e=this.pdfViewer,o=new i.default(n).getJson();return{undo:d(n,e),redo:function(){return n.getPDFPage().markRedactAnnot(o.rects,o).then((function(){f(e,n).active()}))}}},t.prototype[o.ANNOTATION.MAKEREDACTBYPAGES]=function(t){var n=t.redacts,e=(this.pdfViewer,[]);return n.map((function(t){e.push(new i.default(t).getJson())})),{undo:function(){return Promise.all(n.map((function(t){return t.getPDFPage().removeAnnot(t)})))},redo:function(){return Promise.all(n.map((function(t,n){var o=e[n];return t.getPDFPage().markRedactAnnot([o.rect],o)})))}}},t.prototype[o.ANNOTATION.MARKCHECKEDRESULTREDACTION]=function(t){var n=t.redacts,e=[];return n.map((function(t){e.push(new i.default(t).getJson())})),{undo:function(){return Promise.all(n.map((function(t){return t.getPDFPage().removeAnnot(t)})))},redo:function(){return Promise.all(n.map((function(t,n){var o=e[n];return t.getPDFPage().markRedactAnnot([o.rect],o)})))}}},t.prototype[o.ANNOTATION.ADDREVIEWSTATE]=function(t){var n=t.annot,e=t.stateName,o=(this.pdfViewer,n.getPDFPage()),r=n.getUniqueID();return{undo:function(){return o.getAnnotsByIdArray([r]).then((function(t){return t[0]&&t[0].removeReviewState()}))},redo:function(){return o.getAnnotsByIdArray([r]).then((function(t){return t[0]&&t[0].addReviewState(e)}))}}},t.prototype[o.ANNOTATION.DEFAULTAP]=function(t){var n=t.annot,e=t.oldDA,o=t.newDA,r=this.pdfViewer;function i(t){return function(){var e=f(r,n);return e.annot.setDefaultAppearance(t).then((function(){e.active()}))}}return{undo:i(e),redo:i(o)}},t.prototype[o.ANNOTATION.moveAnnotsCrossPage]=function(t){var n=t.srcPage,e=t.destPage,o=t.annots,r=this.pdfViewer.getCurrentPDFDoc(),i=Object.keys(o).reduce((function(t,n){var e=o[n];return t[n]={rect:e.oldRect,oldRect:e.rect},t}),{});return{undo:function(){return r.moveAnnotsToPage(e,n,i,!0)},redo:function(){return r.moveAnnotsToPage(n,e,o,!0)}}},t}();function f(t,n){var e=n.info.id,o=n.page.getIndex(),r=t.getAnnotRender(o,e);return r?r.component:null}function l(t,n,e){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=[],a=t.page;function u(t){var n=r.map((function(n){return t.addReply(n.content).then((function(t){return t.setUniqueID(n.id).then((function(){return t.setCreateDateTime(n.createTime).then((function(){return t.setModifiedDateTime(n.modifiedTime).then((function(){if(n.reviewStateNames.length>0)return T(t,n.reviewStateNames)}))}))}))}))}));return Promise.all(n)}o.map((function(t){var n=t.reviewStates||[],e=[];n.map((function(t){e.push(t.info.state)})),r.push({id:t.getId(),content:t.getContent(),createTime:new Date(t.getCreateDateTime()).getTime(),modifiedTime:new Date(t.getModifiedDateTime()).getTime(),reviewStateNames:e})}));var s=t.reviewStates||[],c=[];s.map((function(t){c.push(t.info.state)}));var l=void 0,d=void 0;return t.info.isMarkup&&t.info.isGrouped?(l=[],t.groupElements.map((function(t,n){l.push(new i.default(t).getJson()),t.isGroupHeader()&&(d=n)}))):l=new i.default(t).getJson(),"redact"===t.info.type?function(){return a.markRedactAnnot(l.rects,l)}:t.info.isMarkup&&t.info.isGrouped?function(){return a.addAnnotGroup(l,d).then((function(){var e=f(n,t);return c.length>0?T(e.annot,c).then((function(){return e})):e})).then((function(t){if(r.length>0)return u(t.annot).then((function(){t.getGroupRenders().map((function(t){!e&&t.active()}))}));t.getGroupRenders().map((function(t){!e&&t.active()}))}))}:function(){return a.addAnnot(l).then((function(){var e=f(n,t);return c.length>0?T(e.annot,c).then((function(){return e})):e})).then((function(t){r.length>0?u(t.annot).then((function(){!e&&t.active()})):!e&&t.active()}))}}function d(t,n){return function(){var e=f(n,t),o=e.annot,r=void 0;r=o.isGrouped&&o.isGrouped()?o.getGroupElements():[e.annot];var i=o.getPDFPage(),a=r.map((function(t){return f(n,t)}));return i.removeAnnot(o).then((function(t){var e=n.getCurrentActivatable();return e&&e.remove?a.forEach((function(t){e.remove(t)})):a.forEach((function(t){n.deactivateElement(t)})),t}))}}function p(t,n,e){return function(){return f(e,t).annot.addReply(n.getContent()).then((function(t){return t.setUniqueID(n.getId()).then((function(){return t.setCreateDateTime(new Date(n.getCreateDateTime()).getTime()).then((function(){return t.setModifiedDateTime(new Date(n.getModifiedDateTime()).getTime()).then((function(){var e=n.reviewStates;if(e.length>0){var o=[];return e.map((function(t){o.push(t.info.state)})),T(t,o)}}))}))}))}))}}function h(t,n,e){return function(){return t.getPDFPage().removeAnnot(n)}}function T(t,n){var e=new u.SerialPromise,o=n.map((function(n){return function(){return t.addReviewState(n)}}));return e.serial(o)}n.default=c},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n}(e(0)).PDFViewCtrl.Consts.BORDER_STYLE,r=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(t){var n,e,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HTML",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a="",u=void 0;"number"==typeof t&&(t=["int",t]);switch(t[0]){case"int":n=(16711680&t[1])>>16,e=(65280&t[1])>>8,o=255&t[1];break;case"T":n=0,e=0,o=0,i=0;break;case"G":n=e=o=255*t[1];break;case"RGB":n=255*t[1],e=255*t[2],o=255*t[3];break;case"CMYK":n=(1-t[4])*(1-t[1])*255,e=(1-t[4])*(1-t[2])*255,o=(1-t[4])*(1-t[3])*255;break;case"r":u=t.match(/rgba?\((\d*),\s*(\d*),\s*(\d*),?\s*([\.0-9]*)?\)/),n=+u[1],e=+u[2],o=+u[3];break;case"#":var s=4==t.length?/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/:/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/;u=t.match(s),n=parseInt(u[1],16),e=parseInt(u[2],16),o=parseInt(u[3],16);break;default:throw new Error("Unsupported color format")}switch(r){case"HTML":a=n===e&&e===o&&-1===o?"transparent":"rgba("+parseInt(n)+","+parseInt(e)+","+parseInt(o)+","+i+")";break;case"RGB":a=["RGB",n/255,e/255,o/255];break;case"#":a+=n<16?"#0"+n.toString(16):"#"+n.toString(16),a+=e<16?"0"+e.toString(16):e.toString(16),a+=o<16?"0"+o.toString(16):o.toString(16);break;case"int":a=0,a|=(i*=255)<<24,a|=n<<16,a|=e<<8,a|=o,a>>>=0}return a}(n.info.borderColor,"int");this.json={objNumber:n.info.objNumber,name:n.info.id,flags:n.info.flag,rect:n.info.rect,color:e,style:n.info.borderInfo.style,contents:n.info.content,date:new Date(n.info.modifiedTimestamp).getTime(),type:n.info.type,borderWidth:n.info.borderInfo.width},n.info.isMarkup&&this.markup(n);var o=n.info.type;switch("strikeout"!==o&&"highlight"!==o&&"squiggly"!==o&&"underline"!==o||this.textMarkup(n),o){case"ink":this.ink(n);break;case"fileattachment":this.fileattachment(n);break;case"polygon":this.polygon(n);break;case"polyline":this.polyline(n);break;case"stamp":this.stamp(n);break;case"freetext":this.freetext(n);break;case"screen":this.screen(n);break;case"line":this.line(n);break;case"redact":this.redact(n);break;case"highlight":this.highlight(n);break;case"link":this.link(n);break;case"square":this.square(n);break;case"circle":this.circle(n)}}return t.prototype.markup=function(t){var n="";if(t.getPopup){var e=t.getPopup();e&&(n=e.id)}this.json=Object.assign({intent:t.info.intent,opacity:t.info.opacity,subject:t.info.subject,title:t.info.title,creationTimestamp:new Date(t.info.creationTimestamp).getTime(),popId:n},this.json)},t.prototype.textMarkup=function(t){var n=[];t.info.quadPoints.map((function(t){n.push({top:t[0].y,left:t[0].x,bottom:t[3].y,right:t[3].x})})),this.json=Object.assign(this.json,{coords:n})},t.prototype.ink=function(t){this.json=Object.assign({inkList:t.info.inkList},this.json)},t.prototype.fileattachment=function(t){this.json=Object.assign({fObjNum:t.info.fObjNum},this.json)},t.prototype.polygon=function(t){var n=i(t.info.borderInfo),e=t.info.measureRatio,o=t.info.measureUnit,r=null;e&&o&&(r={unit:o,ratio:e}),this.json=Object.assign(this.json,{vertexes:t.info.vertexes,borderStyle:n.style,borderStyleParam:n.param,fillColor:t.info.fillColor,style:void 0,measure:r})},t.prototype.polyline=function(t){var n=i(t.info.borderInfo),e=t.info.measureRatio,o=t.info.measureUnit,r=null;e&&o&&(r={unit:o,ratio:e}),this.json=Object.assign(this.json,{vertexes:t.info.vertexes,fillColor:t.info.fillColor,borderStyle:n.style,borderStyleParam:n.param,style:void 0,startStyle:t.info.startStyle,endStyle:t.info.endingStyle,measure:r})},t.prototype.stamp=function(t){this.json=Object.assign({icon:t.info.icon,rotate:(t.info.rotation+360)%360,apObjeNum:t.info.apObjeNum},this.json)},t.prototype.freetext=function(t){var n=i(t.info.borderInfo),e="FreeTextTypewriter"==t.info.intent?0:t.info.fillColor;this.json=Object.assign(this.json,{calloutLinePoints:t.info.calloutLinePoints,innerRect:t.info.innerRect,borderStyle:n.style,borderStyleParam:n.param,style:void 0,"interior-color":e,calloutLineEndingStyle:t.info.calloutLineEndingStyle,defaultAppearance:t.info.defaultAppearance,rotate:t.info.rotation})},t.prototype.line=function(t){var n=i(t.info.borderInfo),e=t.info.measureRatio,o=t.info.measureUnit,r=null;e&&o&&(r={unit:o,ratio:e});var a=t.info.startPoint,u=t.info.endPoint;this.json=Object.assign(this.json,{styleFillColor:t.info.styleFillColor,startStyle:t.info.startStyle,endStyle:t.info.endingStyle,enableCaption:t.info.hasCaption,startPoint:{x:a.x,y:a.y},endPoint:{x:u.x,y:u.y},measure:r,borderStyle:n.style,borderStyleParam:n.param,style:void 0})},t.prototype.screen=function(t){var n=i(t.info.borderInfo);this.json=Object.assign({apObjNum:t.info.apObjNum,opacity:t.info.opacity,rotate:{0:0,90:1,180:2,270:3}[t.info.rotation],iObjNum:t.info.iObjNum,aObjNum:t.info.aObjNum,intensity:n.param},this.json)},t.prototype.redact=function(t){var n=t.info.quadPoints,e=[];n.length>0?n.map((function(t){e.push({left:t[0].x,right:t[3].x,top:t[0].y,bottom:t[3].y})})):e.push(t.info.rect),this.json=Object.assign(this.json,{rects:e,applyFillColor:t.info.applyFillColor})},t.prototype.highlight=function(t){t.info.isArea&&(this.json=Object.assign(this.json,{coords:[t.info.rect],dicts:{AreaHi:"AreaHi"}}),delete this.json.startCharIndex,delete this.json.endCharIndex)},t.prototype.link=function(t){var n=i(t.info.borderInfo);this.json=Object.assign(this.json,{aObjNum:t.info.aObjNum,borderStyle:n.style,borderStyleParam:n.param,style:void 0})},t.prototype.circle=function(t){var n=i(t.info.borderInfo),e=t.info.measureRatio,o=t.info.measureUnit,r=null;e&&o&&(r={unit:o,ratio:e}),this.json=Object.assign(this.json,{fillColor:t.info.fillColor,borderStyle:n.style,borderStyleParam:n.param,style:void 0,measure:r})},t.prototype.square=function(t){var n=i(t.info.borderInfo);this.json=Object.assign(this.json,{fillColor:t.info.fillColor,borderStyle:n.style,borderStyleParam:n.param,style:void 0})},t.prototype.getJson=function(){return this.json},t}();function i(t){var n=t.style,e=t.cloudIntensity,r=t.dashes,i=void 0;switch(n){case o.SOLID:i=[];break;case o.CLOUDY:i=e;break;case o.DASHED:i=r}return{style:n,param:i}}n.default=r},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.action=n,this.json={},this[n.type]()}return t.prototype.TypeGoto=function(){var t=this.action.destination;this.json=Object.assign(t,{type:t.zoomMode})},t.prototype.TypeURI=function(){var t=this.action.uri;this.json=Object.assign({},{uri:t})},t.prototype.TypeJavaScript=function(){var t=this.action.javascript;this.json=Object.assign({},{script:t})},t.prototype.TypeNamed=function(){var t=this.action.name;this.json=Object.assign({},{name:t})},t.prototype.TypeHide=function(){var t=this.action,n=t.fieldNames,e=t.hideState;this.json=Object.assign({},{fieldNames:n,hideState:e})},t.prototype.TypeSubmitForm=function(){var t=this.action,n=t.flags,e=t.url,o=t.fieldNames;this.json=Object.assign({},{flags:n,url:e,fieldNames:o})},t.prototype.TypeResetForm=function(){var t=this.action,n=t.flags,e=t.fieldNames;this.json=Object.assign({},{flags:n,fieldNames:e})},t.prototype.TypeGoToR=function(){var t=this.action,n=t.destinationName,e=t.destination;this.json=Object.assign({},{destinationName:n,destination:e})},t.prototype.toJson=function(){return this.json},t}();n.default=o},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SerialEnhancePromise=n.SerialPromise=n.DebounceAsyncTaskExecutor=n.DebouncePromiseQueue=void 0;var o,r=e(4),i=(o=r)&&o.__esModule?o:{default:o},a=e(15),u=e(17);function s(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var c=function(){},f=function(){function t(){s(this,t),this.queue=[],this.promise=Promise.resolve()}return t.prototype.push=function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.queue.push([t,e]),new Promise((function(t,e){setTimeout((function(){return n.exec()}),o)}))},t.prototype.exec=function(){var t=this;if(!this.execIng){var n=this.queue.pop();if(n){this.execIng=!0;for(var e=0,o=this.queue.length;e<o;e++)this.queue[e][1]();return this.queue=[],Promise.resolve(n[0]()).catch((function(){try{return Promise.resolve(n[1]()).catch(c)}catch(t){}})).finally((function(){t.execIng=!1,setTimeout((function(){t.exec()}),30)}))}}},t.prototype.end=function(){this.queue=[]},t}(),l=function(){function t(){s(this,t),this.executor=new u.QueuedAsyncTaskExecutor}return t.prototype.serial=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.executor.cancel(),this.executor.waitForCurrentRunningTasks().then((function(){return t.executor.resume(),t.executor.execTasks(n.map((function(t){return{task:t}})))}))},t.prototype.push=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.executor.execTasks(n.map((function(t){return{task:t}})))},t.prototype.unshift=function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];return this.executor.insert(n.map((function(t){return{task:t}}))),this.executor.waitForCurrentRunningTasks()},t.prototype.concat=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return n.forEach((function(n){t.executor.exec(n)})),this.executor.waitForCurrentRunningTasks()},t.prototype.exec=function(){return this.executor.waitForCurrentRunningTasks()},t.prototype.end=function(){return this.executor.cancel(),this.executor.waitForCurrentRunningTasks()},t}(),d=function(){function t(){s(this,t),this.queue=[],this.continueExec=!0,this.deferred=(0,i.default)(),this.task=Promise.resolve()}return t.prototype.serial=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.queue=t,this.exec(),this.deferred.promise},t.prototype.push=function(){this.queue.push.apply(this.queue,arguments)},t.prototype.unshift=function(){this.queue.unshift.apply(this.queue,arguments)},t.prototype.concat=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queue.concat(t)},t.prototype.exec=function(){var t=this;if(!this.execIng){this.execIng=!0;var n=this.queue.shift()||[c],e=n[0]();return this.execIngEnd=n[1]||c,Promise.resolve(e).finally((function(){return t.execIng=!1,t.queue.length?t.continueExec?void t.task.then((function(n){return t.exec()})):(t.queue=[],t.deferred.resolve(e)):t.deferred.resolve(e)})).catch(c),this.deferred.promise}},t.prototype.end=function(){if(this.execIng)try{Promise.resolve(this.execIngEnd()).catch(c)}catch(t){}return this.continueExec=!1,this.queue=[],this.deferred.promise},t}();n.DebouncePromiseQueue=f,n.DebounceAsyncTaskExecutor=a.DebounceAsyncTaskExecutor,n.SerialPromise=l,n.SerialEnhancePromise=d},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DebounceAsyncTaskExecutor=void 0;var o=function(){function t(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(n,e,o){return e&&t(n.prototype,e),o&&t(n,o),n}}(),r=a(e(4)),i=a(e(16));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}n.DebounceAsyncTaskExecutor=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;u(this,t),this.interval=n,this.status=t.STATUS_IDLE,this.defer=(0,r.default)(),this.lastTaskPromise=null,this.cancelLast=i.default}return o(t,null,[{key:"STATUS_IDLE",get:function(){return"idle"}},{key:"STATUS_RUNNING",get:function(){return"running"}},{key:"STATUS_READY",get:function(){return"ready"}},{key:"STATUS_CANCELED",get:function(){return"canceled"}},{key:"STATUS_DESTROYED",get:function(){return"destroyed"}}]),t.prototype.exec=function(n,e,o){var i=this;if(this.status!==t.STATUS_DESTROYED){switch(this.status){case t.STATUS_IDLE:case t.STATUS_READY:this.cancelLast();var a=setTimeout((function(a){if(i.status!==t.STATUS_DESTROYED)if(i.status!==t.STATUS_CANCELED){i.status=t.STATUS_RUNNING;var u=i.defer,s=u.resolve,c=u.reject,f=function(){i.status=t.STATUS_IDLE,i.defer=(0,r.default)()};try{var l=n.apply(o,e||[]);l instanceof Promise?l.finally(f).then(s,c):(s(l),f())}catch(n){c(n),i.status=t.STATUS_IDLE}}else i.status=t.STATUS_IDLE}),this.interval);this.cancelLast=function(){clearTimeout(a)};break;case t.STATUS_RUNNING:var u=function(){switch(i.status){case t.STATUS_IDLE:i.status=t.STATUS_READY;break;case t.STATUS_CANCELED:return void(i.status=t.STATUS_IDLE);case t.STATUS_DESTROYED:return}return i.exec(n,e,o)};return this.lastTaskPromise=this.defer.promise.then(u,u)}return this.lastTaskPromise=this.defer.promise}},t.prototype.waitForLastTask=function(t){return this.lastTaskPromise||Promise.resolve(t)},t.prototype.cancel=function(){this.status=t.STATUS_CANCELED},t.prototype.destroy=function(){this.status=t.STATUS_DESTROYED},t}()},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){}},function(t,n,e){"use strict";e.r(n),e.d(n,"QueuedAsyncTaskExecutor",(function(){return r}));var o=e(1),r=function(){function t(){this.runningPromise=o.RESOLVED_PROMISE_VOID,this.isCanceled=!1,this.isRunning=!1,this.inserts=[],this.runningTaskCount=0}return t.prototype.execTasks=function(t){var n=this;if(t.length<1)return Promise.resolve();this.isRunning=!0,this.runningTaskCount+=t.length;var e=t.reduce((function(e,r,i){var a=function(a){if(n.isCanceled)return n.runningPromise=e,i===t.length-1&&(n.isCanceled=!1),n.inserts.length=0,n.runningTaskCount=0,e;(r.args||[]).push(a);var u=function(){var t=r.task.apply(r.context,r.args);return t?(t.finally((function(){return n.runningTaskCount--})),t):(n.runningTaskCount--,o.RESOLVED_PROMISE_VOID)},s=n.executeInserts(e);return s?s.then(u,u):u()};return e?e.then(a,a):r.task.apply(r.context,r.args)}),this.runningPromise),r=function(){if(n.inserts.length>0)return n.execTasks(n.inserts)};return this.runningPromise=e.then(r,r).finally((function(){n.isRunning=!1}))},t.prototype.exec=function(t,n,e){void 0===n&&(n=1);var o=("number"==typeof n?Array(n).fill(0).map((function(t,n){return[n]})):n).map((function(n){return{task:t,args:n,context:e}}));return this.execTasks(o)},t.prototype.insert=function(){for(var t,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];this.isRunning?((t=this.inserts).push.apply(t,n),this.runningTaskCount++):this.execTasks(n)},t.prototype.resume=function(){this.isCanceled=!1},t.prototype.cancel=function(){this.isCanceled=!0},t.prototype.waitForCurrentRunningTasks=function(){return this.runningPromise},t.prototype.getRunningTaskCount=function(){return this.runningTaskCount},t.prototype.executeInserts=function(t){var n=this;if(0!==this.inserts.length)try{this.inserts.reduce((function(t,e){var o=function(){if(n.isCanceled)return n.runningTaskCount=0,t;var o=e.task.apply(e.context,e.args);return"function"==typeof o.finally?(o.finally((function(){n.runningTaskCount--})),o):t};return t?t.then(o,o):o()}),t||o.RESOLVED_PROMISE_VOID)}finally{this.inserts.length=0}},t}()},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default={MARKED:"marked",UNMARKED:"unmarked",ACCEPTED:"accepted",REJECTED:"rejected",CANCELLED:"cancelled",COMPLETED:"completed",NONE:"none"}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.pdfViewer=n}return t.prototype.add=function(t,n){this[t]=n},t}();n.default=o},function(t,n){t.exports=null}]).default}));